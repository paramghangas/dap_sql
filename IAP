--views on paywall screen for last 30 days ; note this is not distinct sessions. A user may have viewed New Sub Paywall multiple times

SELECT date_trunc('day', event_timestamp) as day, count (*) as views 
FROM sp_telegraph.navigation
WHERE event_timestamp > date_trunc('month', (getdate())::date - interval '30 days') 
AND view_type LIKE 'New Subscriber Paywall'
and device_code in ('android', 'andrd_tblt')    -- update device
and product_code = 'hboNow'
GROUP BY 1
ORDER BY 1 ASC

-- views on create profile screen (register)
SELECT date_trunc('day', event_timestamp) as day, count (*) as views 
FROM sp_telegraph.navigation
WHERE event_timestamp > date_trunc('month', (getdate())::date - interval '30 days') 
AND view_type LIKE 'Register'
and device_code in ('android', 'andrd_tblt')    -- update device
and product_code = 'hboNow'
GROUP BY 1
ORDER BY 1 ASC

-- register events

-- purchases (but not fully working on DAP, do not use right now)
SELECT date_trunc('day', event_timestamp) as day, count (*) as purchases,
      FROM sp_telegraph.purchase
      WHERE event_timestamp > date_trunc('month', (getdate())::date - interval '30 days') 
      and device_code in ('android', 'andrd_tblt')    -- update device
		  and product_code = 'hboNow'
      GROUP BY day
      ORDER BY day ASC

--

